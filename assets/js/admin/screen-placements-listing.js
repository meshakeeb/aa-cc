(()=>{"use strict";var e={n:a=>{var t=a&&a.__esModule?()=>a.default:()=>a;return e.d(t,{a:t}),t},d:(a,t)=>{for(var d in t)e.o(t,d)&&!e.o(a,d)&&Object.defineProperty(a,d,{enumerable:!0,get:t[d]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a)};const a=jQuery;var t=e.n(a),d=function(){["advads_frontend_action","advads_frontend_element","advads_frontend_picker","advads_prev_url","advads_frontend_pathtype","advads_frontend_boundary","advads_frontend_blog_id","advads_frontend_starttime"].forEach((function(e){return localStorage.removeItem(e)})),window.Advanced_Ads_Admin.set_cookie("advads_frontend_picker","",-1)};const n=wp.apiFetch;var o=e.n(n);function c(e,a){void 0===a&&(a=!0),t()(e).find("select,input,textarea").add('.submit-placement-form[data-id="'.concat(e.id.replace("advanced-ads-placement-form-",""),'"]')).prop("disabled",a)}function i(e){var a=t()(e),d=a.serialize();c(e),o()({path:"/advanced-ads/v1/placement",method:"PUT",data:{fields:d}}).then((function(d){if(c(e,!1),d.error)return a.prepend('<div class="notice error advads-notice advads-notice-icon inline"><p>'.concat(d.error,"</p></div>")),void a.closest(".advads-modal-content").scrollTop(0);var n=e.closest("dialog");n.advadsTermination.resetInitialValues(),t()("#post-".concat(d.placement_data.id," .column-name .row-title")).text(d.placement_data.title),t()("#post-".concat(d.placement_data.id," .column-ad_group .advads-placement-item-select")).val(d.placement_data.item),wp.hooks.doAction("advanced-ads-placement-updated",d),d.reload?window.location.reload():n.close()}))}function r(e){var a=e.closest("dialog");if("function"==typeof window[a.closeValidation.function]&&!window[a.closeValidation.function](a.closeValidation.modal_id))return;var d=t()(e).serialize();c(e),o()({path:"/advanced-ads/v1/placement",method:"POST",data:{fields:d}}).then((function(a){c(e,!1),a.reload&&window.location.reload()}))}t()(document).on("click",".submit-placement-edit",(function(){i(t()("#advanced-ads-placement-form-".concat(this.dataset.id))[0])})),t()(document).on("click","#submit-new-placement",(function(){r(t()("#advads-placements-new-form")[0])})),t()((function(){!function(){var e=localStorage.getItem("advads_frontend_element"),a=localStorage.getItem("advads_frontend_picker");if(e){var t=document.querySelector('[id="advads-frontend-element-'+a+'"]');if(t.querySelector(".advads-frontend-element").value=e,void 0!==localStorage.getItem("advads_frontend_action")){var n=t.closest("form"),o=new FormData(n);o.set("nonce",advadsglobal.ajax_nonce),o.set("ID",o.get("post_ID")),wp.ajax.post("advads-update-frontend-element",Object.fromEntries(o.entries())).then(d).fail((function(e){return console.error(e)}))}}Array.from(document.querySelectorAll(".advads-activate-frontend-picker")).forEach((function(e){e.addEventListener("click",(function(){localStorage.setItem("advads_frontend_picker",this.dataset.placementid),localStorage.setItem("advads_frontend_action",this.dataset.action),localStorage.setItem("advads_prev_url",window.location),localStorage.setItem("advads_frontend_pathtype",this.dataset.pathtype),localStorage.setItem("advads_frontend_boundary",this.dataset.boundary),localStorage.setItem("advads_frontend_blog_id",window.advancedAds.siteInfo.blog_id),localStorage.setItem("advads_frontend_starttime",(new Date).getTime()),window.Advanced_Ads_Admin.set_cookie("advads_frontend_picker",this.dataset.placementid,null),this.dataset.boundary?window.location=window.advancedAds.content_placement_picker_url:window.location=window.advancedAds.siteInfo.home_url}))})),a&&(document.querySelector('[id="advads-frontend-element-'+a+'"]').querySelector(".advads-deactivate-frontend-picker").style.display="block"),Array.from(document.querySelectorAll(".advads-deactivate-frontend-picker")).forEach((function(e){e.addEventListener("click",(function(){d(),Array.from(document.querySelectorAll(".advads-deactivate-frontend-picker")).forEach((function(e){e.style.display="none"}))}))}))}(),t()(".js-update-placement-item").on("change",(function(){var e=t()(this),a=e.parent(),d=a.find(".advads-loader"),n=a.find(".advads-error");e.prop("disabled",!0),d.removeClass("hidden"),n.html(""),n.hide(),t().ajax({type:"POST",url:advancedAds.endpoints.ajaxUrl,data:{action:"advads-placement-update-item",placement_id:e.data("placement-id"),item_id:e.val()}}).always((function(){e.prop("disabled",!1),d.addClass("hidden")})).fail((function(e){n.html(e.responseJSON.data.message),n.show()})).done((function(e){var d=e.data,n=a.find(".advads-success-message"),o=t()("#advanced-ads-placement-form-"+d.placement_id),c=[a.find(".advads-placement-item-edit"),o.find(".advads-placement-item-edit")];n.addClass("advads-show"),setTimeout((function(){n.removeClass("advads-show")}),2500),c.forEach((function(e){e.attr("href",d.edit_href),e.css("display",""===d.edit_href?"none":"inline")})),o.find(".advads-placement-item-select").val(d.item_id)}))})),wp.hooks.addFilter("advanced-ads-submit-modal-form","advancedAds",(function(e,a){return"advads-placements-new-form"===a.id?(r(a),!1):e})),wp.hooks.addFilter("advanced-ads-submit-modal-form","advancedAds",(function(e,a){return 0===a.id.indexOf("advanced-ads-placement-form-")?(i(a),!1):e})),t()('[id^="advanced-ads-placement-form-"]').each((function(){var e=this.id.replace("advanced-ads-placement-form-","");t()("#modal-placement-edit-".concat(e)).find(".tablenav.bottom").html('<button class="button button-primary submit-placement-edit" data-id="'.concat(e,'">').concat(advadstxt.close_save,"</button>"))})),t()("#modal-placement-new").find(".tablenav.bottom").html('<button class="button button-primary" id="submit-new-placement">'.concat(advadstxt.save_new_placement,"</button>"))}))})();